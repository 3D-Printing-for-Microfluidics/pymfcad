<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<title>OpenMFD Visualizer</title>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
	<link rel="stylesheet" href="static/css/visualizer.css">
</head>

<body>
	<div id="topRightOverlay">
		<div id="viewCube" aria-hidden="true"></div>
		<div id="rightOverlayStack">
			<div id="modelSelector">
				<div style="display:flex;align-items:center;justify-content:space-between;gap:0.5rem;">
					<strong>Models</strong>
					<button id="toggleModelSelectorBtn" class="control-btn" style="padding:0.2rem 0.4rem;font-size:0.75rem;">â€“</button>
				</div>
				<form id="glbForm"></form>
			</div>
			<div id="animationPanel" style="display:none;">
				<div class="panel-header">
					<strong>Animation</strong>
				</div>
				<div class="keyframe-header">
					<span class="keyframe-header-label">Keyframe</span>
					<span class="keyframe-header-label">Time (s)</span>
				</div>
				<div id="keyframeEmpty">No keyframes yet.</div>
				<div id="keyframeList" class="keyframe-list"></div>
				<div class="row-actions" style="gap:0.5rem;flex-wrap:wrap;justify-content:flex-start;">
					<button id="addKeyframeBtn" class="control-btn icon-btn" type="button" title="Add Keyframe">
						<i class="fa-solid fa-plus"></i>
					</button>
					<button id="duplicateKeyframeBtn" class="control-btn icon-btn" type="button" title="Duplicate Keyframe">
						<i class="fa-solid fa-copy"></i>
					</button>
					<button id="moveKeyframeUpBtn" class="control-btn icon-btn" type="button" title="Move Keyframe Up">
						<i class="fa-solid fa-arrow-up"></i>
					</button>
					<button id="moveKeyframeDownBtn" class="control-btn icon-btn" type="button" title="Move Keyframe Down">
						<i class="fa-solid fa-arrow-down"></i>
					</button>
					<button id="removeKeyframeBtn" class="control-btn icon-btn" type="button" title="Remove Keyframe">
						<i class="fa-solid fa-minus"></i>
					</button>
				</div>
				<div class="keyframe-section-title">Playback Control</div>
				<div class="keyframe-playback">
					<button id="keyframePlayBtn" class="control-btn" type="button" title="Play Keyframes">
						<i class="fa-solid fa-play"></i>
						<span>Play</span>
					</button>
					<button id="keyframePlayFromStartBtn" class="control-btn" type="button" title="Play From Beginning">
						<i class="fa-solid fa-backward-step"></i>
						<span>From Start</span>
					</button>
				</div>
			</div>
		</div>
	</div>

	<div id="controls">
		<button id="reloadModelBtn" class="control-btn">Auto Reload: ON</button>
	</div>

	<div id="cameraStripWrapper">
		<button id="updateCameraBtn" class="control-btn" title="Update Camera" style="display:none;position:absolute;bottom:100%;left:50%;transform:translate(-50%,-0.5rem);">Update Camera</button>
		<div class="camera-bar-group">
			<span class="camera-bar-label">Cameras</span>
			<button id="homeCameraBtn" class="control-btn" title="Home Camera">
				<i class="fa-solid fa-house"></i>
			</button>
			<div id="cameraStrip"></div>
			<button id="addCameraBtn" class="control-btn" title="Add Camera">
				<i class="fa-solid fa-plus"></i>
			</button>
		</div>
		<div class="camera-strip-divider" aria-hidden="true"></div>
		<div class="camera-bar-group">
			<span class="camera-bar-label">Tools</span>
			<button id="docsBtn" class="control-btn" title="Documentation">
				<i class="fa-solid fa-book-open"></i>
			</button>
			<button id="saveSnapshotBtn" class="control-btn" title="Save Snapshot">
				<i class="fa-solid fa-camera"></i>
			</button>
			<button id="animationToggleBtn" class="control-btn" title="Animation">
				<i class="fa-solid fa-film"></i>
			</button>
			<button id="settingsDialogBtn" class="control-btn" title="Settings">
				<i class="fa-solid fa-gear"></i>
			</button>
		</div>
	</div>

	<div id="settingsDialog" class="modal">
		<div class="modal-content">
			<div class="modal-header">
				<h3>Settings</h3>
				<button id="settingsDialogClose" class="control-btn">Close</button>
			</div>
			<div class="settings-tabs">
				<button class="tab-btn is-active" data-tab="general">General</button>
				<button class="tab-btn" data-tab="appearance">Appearance</button>
				<button class="tab-btn" data-tab="camera">Camera</button>
				<button class="tab-btn" data-tab="lights">Lights</button>
			</div>
			<div class="tab-panels">
				<div class="tab-panel" data-tab-panel="general">
					<div class="general-grid">
						<div class="modal-section">
							<h4>Environment</h4>
							<div class="input-grid">
								<label>Current Directory (CWD) <input id="cwdValue" type="text" readonly></label>
								<label>Model Source <input id="modelSourceValue" type="text" readonly></label>
							</div>
							<div class="input-grid" style="margin-top:0.5rem;">
								<label>Preview Folder (from CWD)
									<input id="previewDirInput" type="text" placeholder="relative/path">
								</label>
								<div class="row-actions row-actions-inline">
									<button id="previewDirSetBtn" class="control-btn" type="button">Set Folder</button>
									<button id="previewDirResetBtn" class="control-btn" type="button">Reset Folder</button>
								</div>
							</div>
							<div id="previewDirWarning" class="settings-warning" role="alert"></div>
						</div>
						<div class="modal-section">
							<h4>Auto Reload</h4>
							<div class="input-grid">
								<label>Interval (ms)
									<input id="autoReloadIntervalInput" type="number" min="250" step="250">
								</label>
							</div>
						</div>
						<div class="modal-section">
							<h4>Controls</h4>
							<div class="input-grid">
								<label>Default Controls
									<select id="defaultControlTypeSelect">
										<option value="orbit">Orbit</option>
										<option value="trackball">Trackball</option>
									</select>
								</label>
							</div>
						</div>
						<div class="modal-section">
							<h4>General Actions</h4>
							<div class="row-actions" style="margin-top:0.25rem;gap:0.5rem;flex-wrap:wrap;">
								<button id="resetGeneralSettingsBtn" class="control-btn" type="button">Reset General Settings</button>
								<button id="resetThemeSettingsBtn" class="control-btn" type="button">Reset Theme Settings</button>
								<button id="resetCameraSettingsBtn" class="control-btn" type="button">Reset Camera Settings</button>
								<button id="resetLightSettingsBtn" class="control-btn" type="button">Reset Lighting Settings</button>
								<button id="resetAllSettingsBtn" class="control-btn" type="button">Reset All Settings</button>
								<button id="saveSettingsBtn" class="control-btn" type="button">Save Settings</button>
								<button id="loadSettingsBtn" class="control-btn" type="button">Load Settings</button>
								<input id="settingsFileInput" type="file" accept="application/json" style="display:none;">
							</div>
						</div>
					</div>
				</div>
				<div class="tab-panel" data-tab-panel="appearance">
					<div class="appearance-grid">
						<div class="modal-section">
							<h4>Axes</h4>
							<button id="axesToggleBtn" class="control-btn">Axes: On</button>
						</div>
						<div class="modal-section">
							<h4>Themes</h4>
							<div class="input-grid" style="margin-bottom:0.5rem;">
								<label>Theme
									<select id="themeSelect" class="control-btn" style="padding:0.35rem 0.4rem;">
										<option value="dark">Dark</option>
										<option value="light">Light</option>
										<option value="custom">Custom</option>
									</select>
								</label>
							</div>
							<div class="input-grid">
								<label>Background <input id="themeBg" type="color"></label>
								<label>Panel <input id="themePanel" type="color"></label>
								<label>Section <input id="themeSection" type="color"></label>
								<label>Text <input id="themeText" type="color"></label>
								<label>Button BG <input id="themeButtonBg" type="color"></label>
								<label>Button Text <input id="themeButtonText" type="color"></label>
								<label>Button Border <input id="themeButtonBorder" type="color"></label>
								<label>Button Active <input id="themeButtonActive" type="color"></label>
								<label>Axis X <input id="themeAxisX" type="color"></label>
								<label>Axis Y <input id="themeAxisY" type="color"></label>
								<label>Axis Z <input id="themeAxisZ" type="color"></label>
							</div>
							<div class="row-actions">
								<button id="themeToCustomBtn" class="control-btn" type="button">Save as Custom</button>
								<button id="themeResetBtn" class="control-btn" type="button">Reset Theme</button>
							</div>
						</div>
					</div>
				</div>
				<div class="tab-panel is-active" data-tab-panel="camera">
					<div class="modal-body">
						<div class="viewer-pane" id="lightDialogViewer"></div>
						<div class="controls-pane">
							<div class="modal-section">
								<div class="section-header">
									<h4>Camera</h4>
									<div class="section-actions">
										<button id="addCameraBtnSettings" class="control-btn icon-btn" type="button" title="Add Camera">
											<i class="fa-solid fa-plus"></i>
										</button>
										<button id="removeCameraBtnSettings" class="control-btn icon-btn" type="button" title="Remove Camera">
											<i class="fa-solid fa-minus"></i>
										</button>
									</div>
								</div>
								<div class="camera-list" id="cameraList"></div>
								<div class="camera-action-row" style="display:flex;gap:0.5rem;margin-bottom:0.5rem;flex-wrap:wrap;">
									<button id="cameraModeBtn" class="control-btn" type="button">Camera: Perspective</button>
									<button id="centerTargetBtn" class="control-btn" type="button">Center Target</button>
									<button id="resetCameraBtn" class="control-btn" type="button">Reset Camera</button>
								</div>
								<div class="input-grid" style="margin-bottom:0.5rem;">
									<label>Camera Controls
										<select id="cameraControlTypeSelect">
											<option value="orbit">Orbit</option>
											<option value="trackball">Trackball</option>
										</select>
									</label>
								</div>
								<div class="input-grid">
									<label>Pos X <input id="camPosX" type="number" step="0.1"></label>
									<label>Pos Y <input id="camPosY" type="number" step="0.1"></label>
									<label>Pos Z <input id="camPosZ" type="number" step="0.1"></label>
									<label>Target X <input id="camTargetX" type="number" step="0.1"></label>
									<label>Target Y <input id="camTargetY" type="number" step="0.1"></label>
									<label>Target Z <input id="camTargetZ" type="number" step="0.1"></label>
									<label>Roll (deg) <input id="camRoll" type="number" step="1"></label>
									<label>FOV (deg) <input id="camFov" type="number" step="1" min="5" max="120"></label>
								</div>
								<div class="row-actions row-actions-center">
									<button class="control-btn" type="button" data-camera-preset="front">Front</button>
									<button class="control-btn" type="button" data-camera-preset="back">Back</button>
									<button class="control-btn" type="button" data-camera-preset="left">Left</button>
									<button class="control-btn" type="button" data-camera-preset="right">Right</button>
									<button class="control-btn" type="button" data-camera-preset="top">Top</button>
									<button class="control-btn" type="button" data-camera-preset="bottom">Bottom</button>
								</div>
							</div>

						</div>
					</div>
				</div>
				<div class="tab-panel" data-tab-panel="lights">
					<div class="modal-body">
						<div class="viewer-pane" id="lightsDialogViewer"></div>
						<div class="controls-pane">
							<div class="modal-section">
								<h4>Ambient Light</h4>
								<div class="input-grid">
									<label>Color <input id="ambientColor" type="color"></label>
									<label>Intensity <input id="ambientIntensity" type="number" step="0.1" min="0"></label>
								</div>
							</div>

							<div class="modal-section">
								<div class="section-header">
									<h4>Light Sources</h4>
									<div class="section-actions">
										<button id="addDirLightBtn" class="control-btn icon-btn" type="button" title="Add Directional Light">
											<i class="fa-solid fa-plus"></i>
										</button>
										<button id="removeDirLightBtn" class="control-btn icon-btn" type="button" title="Remove Directional Light">
											<i class="fa-solid fa-minus"></i>
										</button>
									</div>
								</div>
								<div id="directionalLightsList"></div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<div id="previewSettingsDialog" class="modal">
		<div class="modal-content" style="max-width:520px;">
			<div class="modal-header">
				<h3>Load Settings</h3>
				<button id="previewSettingsClose" class="control-btn">Close</button>
			</div>
			<div class="modal-body" style="grid-template-columns: 1fr;">
				<div class="modal-section">
					<h4>Settings File</h4>
					<div class="input-grid">
						<label>File
							<select id="previewSettingsFileSelect"></select>
						</label>
					</div>
				</div>
				<div class="modal-section">
					<h4>Sections</h4>
					<div class="input-grid">
						<label><input id="previewSettingsGeneral" type="checkbox" checked> General</label>
						<label><input id="previewSettingsTheme" type="checkbox" checked> Theme</label>
						<label><input id="previewSettingsCamera" type="checkbox" checked> Camera</label>
						<label><input id="previewSettingsLighting" type="checkbox" checked> Lighting</label>
					</div>
				</div>
				<div class="row-actions" style="gap:0.5rem;flex-wrap:wrap;">
					<button id="previewSettingsLoadBtn" class="control-btn" type="button">Load Selected</button>
					<input id="previewSettingsFileInput" type="file" accept="application/json" style="display:none;">
				</div>
			</div>
		</div>
	</div>

	<div id="snapshotDialog" class="modal">
		<div class="modal-content" style="max-width:560px;">
			<div class="modal-header">
				<h3>Save Snapshot</h3>
				<button id="snapshotDialogClose" class="control-btn">Close</button>
			</div>
			<div class="modal-body" style="grid-template-columns: 1fr;">
				<div class="modal-section">
					<h4>Output</h4>
					<div class="input-grid">
						<label>Resolution Scale
							<input id="snapshotScale" type="number" min="0.25" max="4" step="0.25" value="1">
						</label>
						<label>File Name
							<input id="snapshotFileName" type="text" value="openmfd-viewport.png">
						</label>
					</div>
				</div>
				<div id="snapshotProgress" class="snapshot-progress"></div>
				<div class="row-actions" style="gap:0.5rem;flex-wrap:wrap;">
					<button id="snapshotSaveBtn" class="control-btn" type="button">Save Snapshot</button>
				</div>
			</div>
		</div>
	</div>

	<script type="module" src="static/js/app.js"></script>
</body>

</html>
